[ZooKeeper](https://zookeeper.apache.org/) 注册中心是一个分布式的，开放源码的分布式应用程序协调服务。它是一个为分布式应用提供一致性服务的软件，提供的功能包括：配置维护、域名服务、分布式同步、组服务等。

Zookeeper 从设计模式角度来理解：是一个基于观察者模式设计的分布式服务管理框架，它**负责存储和管理大家都关心的数据，然后接受观察者的注册**，一旦这些数据的状态发生变化，Zookeeper 就将**负责通知已经在 Zookeeper 上注册的那些观察者**做出相应的反应，从而实现集群中类似 Master/Slave 管理模式。Zookeeper=文件系统+通知机制。

# 特点

- 一个领导者（leader），多个跟随者（follower）组成的集群；集群最少需要3台机器！！
  - Leader 负责进行投票的发起和决议，更新系统状态
  - Follower 用于接收客户请求并向客户端返回结果，在选举 Leader 过程中参与投票
- 集群中只要有半数以上节点存活，Zookeeper 集群就能正常服务。
- 全局数据一致：每个 server 保存一份相同的数据副本，client 无论连接到哪个 server，数据都是一致的。
- 更新请求顺序进行，来自同一个 client 的更新请求按其发送顺序依次执行。
- 数据更新原子性，一次数据更新要么成功，要么失败。
- 实时性，在一定时间范围内，client 能读到最新数据
- 可靠性，每次对zk的操作状态都会保存在服务端



# 数据结构

ZooKeeper 数据模型的结构**与 Unix 文件系统很类似**，整体上可以看作是一棵树，每个节点称做一个 Znode。

每一个 Znode默认能够存储**1MB**的数据，每个 ZNode都可以**通过其路径唯一标识**。



# 应用场景

提供的服务包括：分布式消息同步和协调机制、服务器节点动态上下线、统一配置管理、负载均衡、集群管理等。

- 统一命名服务
  - 在分布式环境下，经常需要对应用/服务进行统一命名，便于识别。如：域名比IP地址容易记忆。
- **统一配置管理**
  - 在分布式环境下，配置文件同步很常见。
    - 一般要求一个集群中，所有节点的配置信息是一致的，如Kafka集群
    - 对配置文件修改后，希望能快速同步到各个节点上。
  - 配置管理可交由Zookeeper实现
    - 即只需部署一台服务器，则可把相同的配置文件同步更新到其他所有服务器！
    - 可将配置信息写入Zookeeper上的一个Znode
    - 各个客户端服务器监听这个Znode
    - 一旦Znode中数据被修改，Zookeeper将通知各个客户端服务器
- 统一**集群管理**，集群中保证数据的强一致性
  - 分布式环境中，实时掌握每个节点的状态是必要的。
    - 可根据节点实时状态做出一些调整。
  - ZooKeeper可以实现实时监控节点状态变化
    - 可将节点信息写入ZooKeeper上的一个ZNode。
    - 监听这个ZNode可获取它的实时状态变化。
- **数据发布与订阅**
  - 应用启动时主动到Zookeeper上获取配置信息，并注册Watcher监听；
  - 配置管理员变更Zookeeper配置节点的内容；
  - Zookeeper推送变更到应用，触发Watcher回调函数；
  - 应用根据逻辑，主动获取新的配置信息，更改自身逻辑。
- 软负载均衡
  - Register负责域名的注册，服务启动后将域名信息通过Register注册到Zookeeper相对应的域名服务下。
  - Dispatcher负责域名的解析。可以实现软负载均衡。
  - Scanner通过定时监测服务状态，动态更新节点地址信息。
  - Monitor负责收集服务信息与状态监控。
  - Controller提供后台Console，提供配置管理功能。
- **提供分布式锁**





